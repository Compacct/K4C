<p-toast key="compacct-toast" baseZIndex="99999"></p-toast>
<p-toast position="center" key="c" (onClose)="onReject()" [modal]="true" [autoZIndex]="true">
    <ng-template let-message pTemplate="message">
        <div style="text-align: center">
            <i class="pi pi-exclamation-triangle" style="font-size: 3em"></i>
            <h3>{{message.summary}}</h3>
            <p *ngIf="checkSave">{{message.detail}}</p>
        </div>
        <form  name="cancleForm" #cancleForm="ngForm" novalidate>
            <div style="text-align: center" *ngIf="Can_Remarks">
                <label class="control-label">Remarks <sup class="text-danger">*</sup></label>
                <input class="form-control" name="cancleremarks" #cancleremarks="ngModel" [(ngModel)]="Cancle_Remarks" [ngClass]="{'clearance':cancleFormSubmitted && cancleremarks?.errors?.required}" required>
            </div>
        </form>
        <div *ngIf="checkSave" class="ui-g ui-fluid">
            <div class="ui-g-6" *ngIf="Can_Remarks">
                <button type="button" pButton (click)="onConfirm(cancleForm.form.valid)" label="Yes" class="ui-button-success"></button>
            </div>
            <div class="ui-g-6" *ngIf="!Can_Remarks">
                <button type="button" pButton (click)="onConfirm2()" label="Yes" class="ui-button-success"></button>
            </div>
            <div class="ui-g-6">
                <button type="button" pButton (click)="onReject()" label="No" class="ui-button-secondary"></button>
            </div>
        </div>
    </ng-template>
</p-toast>

<div class="row">
    <div class="col-xs-12">
        <div class="box box-primary">
            <div class="form-horizontal">
                <div class="box-body">
                    <p-tabView [activeIndex]="tabIndexToView" (onChange)="TabClick($event)">
                        <p-tabPanel headerStyleClass="compacct-tabs" [header]="items[0]" *ngIf='!CustomerDisabledFlag' leftIcon="glyphicon glyphicon-list-alt">
                            <div class="col-lg-6">
                                <div class="panel-group">
                                    <div class="panel panel-primary">
                                        <div class="panel-body">
                                            <form name="AdvaceorderForm" #AdvaceorderForm="ngForm" novalidate>
                                                <div class="form-group">
                                                    <div class="col-sm-5">
                                                        <label class="control-label">Search By</label>
                                                        <select class="form-control" name="Search_By" [(ngModel)]="Search_By">

                                                      <!-- <option  [ngValue]="undefined">Select</option> -->
                                                      <option value="Delivery Date">Delivery Date</option>
                                                      <option value="Order Date">Order Date</option>
                                                </select>
                                                    </div>

                                                    <div class="col-sm-7">
                                                        <label class="control-label">Date Range</label>

                                                        <app-compacct-daterangepicker (DaterangeObj)="getDateRange($event)" [DefaultDateOpt]="'weekwise'" required>
                                                        </app-compacct-daterangepicker>

                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-sm-7">
                                                        <label class="control-label">Delivery Location</label>
                                                        <select class="form-control" name="BroeItem" #BroeItem="ngModel" [(ngModel)]="ObjaddbillForm.BrowserDeliveryto" [disabled]="$CompacctAPI.CompacctCookies.User_Type != 'A'">
                                             <option  [ngValue] ="undefined">Select</option>
                                              <option *ngFor = "let option of returnedID" [value] ="option.Cost_Cen_ID">
                                               {{option.Cost_Cen_Name}}
                                              </option>
                                            </select>
                                                    </div>
                                                    <div class="col-sm-4">
                                                        <button class="btn btn-primary custombutton2" data-toggle="modal" (click)="Showdata()" id="load" [disabled]="seachSpinner">
                                             <p-progressSpinner *ngIf="seachSpinner" [style]="{width: '15px', height: '15px'}" strokeWidth="8"  animationDuration=".5s"></p-progressSpinner>
                                         <span *ngIf="!seachSpinner" ></span>Show
                                     </button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="panel-group">
                                    <div class="panel panel-primary">
                                        <div class="panel-body">
                                            <form name="MobileSubmitForm" #MobileSubmitForm="ngForm" novalidate>
                                                <div class="form-group">
                                                    <div class="col-sm-7">
                                                        <label class="control-label">Customer Mobile</label>
                                                        <input type="text" placeholder="Customer Mobile" name="Custmobile" #Custmobile="ngModel" [(ngModel)]="Objcustomerdetail.Costomer_Mobile" CompacctDigitonly="true" maxlength="10" minlength="10" class="form-control" [ngClass]="{clearance:MobileSubmitFormSubmitted && Custmobile.errors?.required}"
                                                            required>
                                                        <!-- <p-calendar [(ngModel)]="today" [showIcon]="true"></p-calendar> -->
                                                    </div>

                                                    <div class="col-sm-3">
                                                        <button class="btn btn-primary custombutton3" data-toggle="modal" (click)="Showdatabymobile(MobileSubmitForm.form.valid)" id="load2" [disabled]="mobSpinner">
                                             <p-progressSpinner *ngIf="mobSpinner" [style]="{width: '15px', height: '15px'}" strokeWidth="8"  animationDuration=".5s"></p-progressSpinner>
                                         <span *ngIf="!mobSpinner"></span>Show
                                     </button>
                                                    </div>
                                                </div>

                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="clearfix"></div>

                            <div class="table-responsive no-padding table-id">
                                <p-table [value]="Searchlist" [rows]="100" [rowHover]="true" [paginator]="true" [autoLayout]="true" sortMode="multiple" [loading]="seachSpinner" [rowsPerPageOptions]="[100, 300, 500]" [globalFilterFields]="['Adv_Order_No','Order_Date','Del_Date','Del_Date_Time','Customer_Name',
                                          'Costomer_Mobile','Total_Amount','Total_Paid','Net_Due','Bill_No','Bill_Date','Billing_Outlet']" [rowHover]="true" #dt>
                                    <ng-template pTemplate="caption">
                                        <div class="row">
                                            <div class="col-sm-3 pull-right" style="text-align: right">
                                                <input type="text" pInputText size="50" placeholder="Search" (input)="dt.filterGlobal($event.target.value, 'contains')" class="searchInput form-control">
                                            </div>
                                        </div>

                                    </ng-template>
                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th style="width:5em">Action</th>
                                            <th>Order No</th>
                                            <th>Order Date</th>
                                            <th>Delivery Location</th>
                                            <th>Delivery Date & Time</th>
                                            <th>Name</th>
                                            <th>Mobile No</th>
                                            <th>Total Amount</th>
                                            <th>Total Paid</th>
                                            <th>Net Due</th>
                                            <th>Refund Amount</th>
                                            <th>Bill No</th>
                                            <th>Bill Date</th>
                                            <th>Billing Outlet</th>
                                            <th>Transaction Date & Time</th>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="body" let-col let-rowIndex="rowIndex">
                                        <tr [class]='col.Cancel_Order === "Y" ? "text-red-active" : ""'>

                                            <td>
                                                <div class="dropdown">
                                                    <button class="btn btn-default btn-sm tableButton dropdown-toggle" type="button" data-toggle="dropdown" style="height:27px">
                                                                    <i class="fa fa-fw fa-bars"></i>
                                                                    <span class="caret"></span>
                                                                </button>
                                                    <ul class="dropdown-menu">
                                                        <li *ngIf='col.Cancel_Order === "N" && col.Can_Modify ==="Y" && !col.Bill_No'>
                                                            <a (click)="CreateBill(col,'editorder')">
                                                                <i class="fa fa-fw fa-pencil"></i> Edit
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a (click)="PrintOrder(col)">
                                                                <i class="fa fa-print" aria-hidden="true"></i> Order Print
                                                            </a>
                                                        </li>
                                                        <li *ngIf='col.Cancel_Order === "N" && col.Can_Cancel === "Y"'>
                                                            <a (click)="Cancle(col)">
                                                                <i class="fa fa-times" aria-hidden="true"></i> Cancel
                                                            </a>
                                                        </li>
                                                        <li *ngIf='col.Cancel_Order === "N" && !col.Bill_No && col.Cost_Cent_ID == col.Del_Cost_Cent_ID'>
                                                            <a (click)="CreateBill(col,'advordertosalebill')">
                                                                <i class="fa fa-file-text-o" aria-hidden="true"></i> Create Bill
                                                            </a>
                                                        </li>
                                                        <li *ngIf='col.Bill_No'>
                                                            <a (click)="PrintBill(col)">
                                                                <i class="fa fa-print" aria-hidden="true"></i> Bill Print
                                                            </a>
                                                        </li>
                                                        <li *ngIf='col.Cancel_Order === "N" && col.Net_Due > 0 && col.Net_Due != 0'>
                                                            <a (click)="MakePayment(col)">
                                                                <i class="fa fa-inr" aria-hidden="true"></i> Make Payment
                                                            </a>
                                                        </li>
                                                        <li *ngIf='col.Cancel_Order === "N"'>
                                                            <a (click)="Refund(col)">
                                                                <i class="fa fa-money" aria-hidden="true"></i> Refund
                                                            </a>
                                                        </li>
                                                        <li *ngIf='col.Cancel_Order === "N" && col.Can_Modify ==="Y" && !col.Bill_No'>
                                                            <a (click)="getPhotoprolist(col)">
                                                                <i class="fa fa-picture-o"></i> Show Image
                                                            </a>
                                                        </li>
                                                        <li *ngIf='$CompacctAPI.CompacctCookies.User_Type === "A" && col.Total_Paid && col.Cancel_Order === "N"'>
                                                            <a (click)="UpdatePaymentMode(col)">
                                                                <i class="fa fa-money"></i> Update Payment Mode
                                                            </a>
                                                        </li>
                                                        <li *ngIf='$CompacctAPI.CompacctCookies.User_Type === "A" && col.Cancel_Order === "N"'>
                                                            <a (click)="DelMulPayments(col)">
                                                                <i class="fa fa-trash"></i> Delete Multiple Payments
                                                            </a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </td>
                                            <td>{{col.Adv_Order_No}}</td>
                                            <td>{{col.Order_Date | date: "dd/MMM/yyyy"}}</td>
                                            <td>{{col.Delivery_Location}}</td>
                                            <td>{{col.Del_Date | date: "dd/MMM/yyyy"}} - {{col.Del_Date_Time}}</td>
                                            <td>{{col.Customer_Name}}</td>
                                            <td>{{col.Costomer_Mobile}}</td>
                                            <td>{{col.Total_Amount}}</td>
                                            <td>{{col.Total_Paid}}</td>
                                            <td>{{col.Net_Due}}</td>
                                            <td>{{col.Refund_Amt}}</td>
                                            <td>{{col.Bill_No}}</td>
                                            <td>{{col.Bill_Date}}</td>
                                            <td>{{col.Billing_Outlet}}</td>
                                            <td>{{col.Transaction_Date_Time}}</td>
                                        </tr>
                                        <tr *ngIf='rowIndex === (Searchlist.length - 1)'>
                                            <td colspan="7" class="text-right">Total</td>
                                            <td>{{getTotalValue('Total_Amount')}}</td>
                                            <td>{{getTotalValue('Total_Paid')}}</td>
                                            <td colspan="5"></td>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="paginatorright" let-state>
                                        Showing {{state.first+1}} of {{(state.first+1) + state.rows}} of {{state.totalRecords}}
                                    </ng-template>
                                </p-table>
                            </div>
                            <!-- MAKE PAYMENT -->
                            <p-dialog header="PAYMENT" [appendTo]="'body'" [visible]="MakePaymentModal" [closeOnEscape]="true" [closable]="false" [modal]="true" [responsive]="true" [style]="{ width: '30%', minWidth: '200px' }" style="text-align: center;" [minY]="80" [maximizable]="true"
                                [baseZIndex]="10000">
                                <div class="col-sm-6">
                                    <div class="box box-successMP wellMP well-smMP shadow">
                                        <div class="form-horizontal">
                                            <div class="box-body">
                                                <div class="form-group">
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Amount Payable:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{Amount_Payable}}
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Cash Amount:</label>
                                                        <input class="form-control" type="text" style="text-align: center" name="cash" #cash="ngModel" [(ngModel)]="ObjcashForm.Cash_Amount" (ngModelChange)="AmountChange()" CompacctDigitonly="true">
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Wallet Amount: </label>
                                                        <div class="input-group">
                                                            <div class="input-group-addon">
                                                                <select name="wallet" #wallet="ngModel" [(ngModel)]="ObjcashForm.Wallet_Ac_ID" [disabled]='QueryStringObj?.Txn_ID'>
                                                              <option [ngValue]="undefined">select</option>
                                                              <option *ngFor = "let option of walletlist" [value] ="option.Txn_ID">
                                                                  {{option.Ledger_Name}}
                                                              </option>
                                                          </select>
                                                            </div>
                                                            <input type="text" class="form-control" id="exampleInputAmount" name="Wallet" #Wallet="ngModel" [(ngModel)]="ObjcashForm.Wallet_Amount" (ngModelChange)="AmountChange()" CompacctDigitonly="true" [disabled]='QueryStringObj?.Txn_ID'>
                                                        </div>
                                                    </div>

                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Card Amount: </label>
                                                        <input class="form-control" type="text" style="text-align: center" name="card" #card="ngModel" [(ngModel)]="ObjcashForm.Card_Amount" (ngModelChange)="AmountChange()" CompacctDigitonly="true">
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Credit to Account:</label>
                                                        <div class="input-group">
                                                            <div class="input-group-addon">
                                                                <select name="Credit" #Credit="ngModel" [(ngModel)]="ObjcashForm.Credit_To_Ac_ID">
                                                                    <option [ngValue]="undefined">select</option>
                                                                    <option *ngFor = "let option of creditlist" [value] ="option.Txn_ID">
                                                                        {{option.Ledger_Name}}
                                                                    </option>
                                                                </select>
                                                            </div>
                                                            <input type="text" class="form-control" id="exampleInputAmount1" name="credit" #credit="ngModel" [(ngModel)]="ObjcashForm.Credit_To_Amount" (ngModelChange)="AmountChange()" CompacctDigitonly="true">
                                                        </div>
                                                    </div>

                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Total Paid:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{ObjcashForm.Total_Paid}}
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Net Due:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{ObjcashForm.Net_Due}}
                                                    </div>

                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <p-footer>
                                    <button type="button" (click)="CloseMPaymentModal()" class="btn btn-default">
                                  CLOSE
                                </button>
                                    <button type="button" (click)="AddPamentsaveCheck()" class="btn btn-success">
                                  ADD PAMENT
                                </button>
                                </p-footer>
                            </p-dialog>

                        </p-tabPanel>
                        <p-tabPanel headerStyleClass="compacct-tabs" [header]="items[1]" *ngIf='CustomerDisabledFlag' leftIcon="glyphicon glyphicon-floppy-save">
                            <form name="addbillForm" #addbillForm="ngForm" novalidate>
                                <fieldset ng-disabled="ctrl.productCategoryView" aria-disabled="false">
                                    <div class="form-group">
                                        <div class="col-sm-3">
                                            <label class="control-label">Order Date</label>
                                            <input class="form-control" name="Doc_Date" [disabled]="true" [ngModel]="myDate  | date :'dd-MMM-yyyy'" (ngModelChange)='myDate = $event'>
                                        </div>
                                        <div class="col-sm-3">
                                            <label class="control-label">Delivery Date</label>
                                            <ejs-datepicker [(value)]="delivery_Date" [format]="'dd/MMM/yyyy'" name="Del_Date" #Del_Date2 #Del_Date="ngModel" [ngModel]="delivery_Date" [min]='minDelDate' (change)='DeliveryChange($event)'></ejs-datepicker>
                                            <!-- (close)="enableButton($event)" <input class="form-control"
                                     type="date"
                                     name="Delivey_Date"
                                     #Delivey_Date = "ngModel"
                                     [ngModel]="delivery_Date | date:'yyyy-MM-dd'"
                                         (ngModelChange)="delivery_Date = $event"> -->


                                        </div>
                                        <div class="col-sm-3">
                                            <label class="control-label">Delivery Time</label>
                                            <!-- <ejs-datetimepicker
                                     [(value)]="Delivey_Time"
                                     [format]="'hh:mm a'"
                              ></ejs-datetimepicker> -->
                                            <ejs-timepicker placeholder='Select a time' [(value)]="Objcustomerdetail.Del_Date_Time" name="Del_Date_Time" #Del_Date_Time="ngModel" #Del_time name='timepic' [ngModel]="Objcustomerdetail.Del_Date_Time" (change)='DeliveryTimeChange($event)' [format]="'hh:mm a'"
                                                [value]='TimeValue' [min]='minTime' [max]='maxTime'></ejs-timepicker>
                                            <!-- <input class="form-control"
                                     type="time"
                                     name="Delivey_Time"
                                     id='Delivey_Time'
                                     #Delivey_Time = "ngModel"
                                     [(ngModel)] ="Objcustomerdetail.Del_Date_Time"
                                     (keydown)="onKeydownMain($event,'delLocation')"> -->


                                        </div>
                                        <div class="col-sm-3">
                                            <label class="control-label">Outlet</label>
                                            <select class="form-control" name="Outlet" id='outlet' #selectitem2="ngModel" [(ngModel)]="ObjaddbillForm.selectitem" (change)='getselectitem()' [disabled]="true" [disabled]='productSubmit.length' (keydown)="onKeydownMain($event,'delLocation')">
                              <option  [ngValue]="undefined">Select</option>
                              <option *ngFor = "let option of returnedID" [value] ="option.Cost_Cen_ID">
                                  {{option.Cost_Cen_Name}}
                                </option>
                          </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <div class="col-sm-3">
                                            <label class="control-label">Delivery Location</label>
                                            <div class="pull-right">
                                                <button class="button1" (click)="ShowHomeDeliverypopup()">Home Delivery</button>
                                            </div>
                                            <select class="form-control" name="delLocation" id='delLocation' #Del_Cost_Cent_ID="ngModel" [(ngModel)]="Objcustomerdetail.Del_Cost_Cent_ID" (keydown)="onKeydownMain($event,'Product')">
                                      <option  [ngValue]="undefined">Select</option>
                               <option *ngFor = "let option of delloclist" [value] ="option.Cost_Cen_ID">
                                  {{option.Cost_Cen_Name}}
                                </option>
                          </select>
                                        </div>
                                        <div class="col-sm-3" *ngIf="$CompacctAPI.CompacctCookies.User_Type === 'A'">
                                            <label class="control-label">Product <sup class="text-danger">*</sup> &nbsp;</label>
                                            <div class="dropdown pull-right">
                                                <select class="dropdown-content" name="brandid" #brandid="ngModel" [(ngModel)]="Brand_ID" (change)="GetProduct()" [disabled]="productSubmit.length">
                                                 <option  [ngValue]="undefined">Select Brand</option>
                                                 <option *ngFor="let option of BrandList" value="{{option.Brand_ID}}">
                                                 {{option.Brand_INI}}
                                                 </option>
                                                </select>
                                              </div>
                                            <p-dropdown [options]="selectitem" name="Product" #Product2 [(ngModel)]="ObjaddbillForm.Product_ID" [showClear]="true" [emptyFilterMessage]="' No Product Found'" (onChange)="ProductChange()" [filter]="true" filterBy="label,value.name" [resetFilterOnHide]="true"
                                                [placeholder]="'Select Product'" [disabled]="selectitem.length === 0" [virtualScroll]="true" itemSize="30" #Product="ngModel" [required]="true" (keydown)="onKeydownMain($event,'Net_Price')" [ngClass]="{'clearance':addbillFormSubmitted && Product?.errors?.required}"
                                                required>
                                            </p-dropdown>
                                        </div>
                                        <div class="col-sm-3" *ngIf="$CompacctAPI.CompacctCookies.User_Type != 'A'">
                                            <label class="control-label">Product <sup class="text-danger">*</sup> &nbsp;</label>
                                            <p-dropdown [options]="selectitem" name="Product" #Product2 [(ngModel)]="ObjaddbillForm.Product_ID" [showClear]="true" [emptyFilterMessage]="' No Product Found'" (onChange)="ProductChange()" [filter]="true" filterBy="label,value.name" [resetFilterOnHide]="true"
                                                [placeholder]="'Select Product'" [disabled]="selectitem.length === 0" [virtualScroll]="true" itemSize="30" #Product="ngModel" [required]="true" (keydown)="onKeydownMain($event,'Net_Price')" [ngClass]="{'clearance':addbillFormSubmitted && Product?.errors?.required}"
                                                required>
                                            </p-dropdown>
                                        </div>

                                        <div class="col-sm-1">
                                            <label class="control-label">Rate <sup class="text-danger">*</sup></label>
                                            <input class="form-control" name="Net_Price" #Net_Price="ngModel" id='Net_Price' [(ngModel)]="ObjaddbillForm.Sale_rate" CompacctDigitonly="true" (keydown)="onKeydownMain($event,'Qty')" [ngClass]="{'clearance':addbillFormSubmitted && Net_Price?.errors?.required}"
                                                required>
                                        </div>
                                        <div class="col-sm-1">
                                            <label class="control-label">Qty <sup class="text-danger">*</sup></label>
                                            <input class="form-control" name="Qty" id='Qty' #Qty="ngModel" [(ngModel)]="ObjaddbillForm.Stock_Qty" (keydown)="onKeydownMain($event,'Weight_in_Pound')" [ngClass]="{'clearance':addbillFormSubmitted && Qty?.errors?.required}" required CompacctDigitonly="true">
                                        </div>
                                        <!-- <div class="col-sm-1">
                            <label class="control-label">Disc %</label>
                            <input
                                  class="form-control"
                                   name="Max_Discount"
                                   #Max_Discount = "ngModel"
                                   [value] = "0"
                                   id='Disc'
                                   [(ngModel)] ="ObjaddbillForm.Max_Discount"
                                   (keydown)= "onKeydownMain($event,'Modifier')"
                                   CompacctDigitonly="true"
                                   >
                        </div> -->

                                        <div class="col-sm-2">
                                            <label class="control-label">Weight in Pound <sup class="text-danger">*</sup></label>
                                            <input class="form-control" name="Weight_in_Pound" #Weight_in_Pound="ngModel" id='Weight_in_Pound' [(ngModel)]="ObjaddbillForm.Weight_in_Pound" (keydown)="onKeydownMain($event, 'Acompanish')" [ngClass]="{'clearance':addbillFormSubmitted && Weight_in_Pound?.errors?.required}"
                                                CompacctDigitonly="true" required>
                                        </div>
                                        <div class="col-sm-2">
                                            <label class="control-label">Accomplishment Amt<sup class="text-danger">*</sup></label>
                                            <input class="form-control" name="Acompanish" #Acompanish="ngModel" id='Acompanish' [(ngModel)]="ObjaddbillForm.Acompanish" (keydown)="onKeydownMain($event, 'Flavour')" [ngClass]="{'clearance':addbillFormSubmitted && Acompanish?.errors?.required}" CompacctDigitonly="true"
                                                required>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <div class="col-sm-2">
                                            <label class="control-label">Flavour</label>
                                            <select class="form-control" name="Flavour" id='Flavour' #Flavour="ngModel" [(ngModel)]="ObjaddbillForm.Flavour" (keydown)="onKeydownMain($event,'Finishing')">
                                      <option  [ngValue]="undefined" >Select</option>
                                <option *ngFor="let option of FlavourList"  [value] ="option.Txn_ID">
                                  {{option.Field_Value}}
                                </option>
                          </select>
                                        </div>
                                        <div class="col-sm-2">
                                            <label class="control-label">Finishing</label>
                                            <select class="form-control" name="Finishing" id='Finishing' #Finishing="ngModel" [(ngModel)]="ObjaddbillForm.Finishing" (keydown)="onKeydownMain($event,'Shape')">
                                      <option  [ngValue]="undefined">Select</option>
                                <option *ngFor = "let option of Finishinglist" [value] ="option.Txn_ID">
                                  {{option.Field_Value}}
                                </option>
                          </select>
                                        </div>
                                        <div class="col-sm-2">
                                            <label class="control-label">Shape</label>
                                            <select class="form-control" name="Shape" id='Shape' #Shape="ngModel" [(ngModel)]="ObjaddbillForm.Shape" (keydown)="onKeydownMain($event,'Tier')">
                                      <option  [ngValue]="undefined">Select</option>
                                  <option *ngFor = "let option of Shapelist" [value] ="option.Txn_ID">
                                        {{option.Field_Value}}
                                  </option>
                          </select>
                                        </div>
                                        <div class="col-sm-2">
                                            <label class="control-label">Tier</label>
                                            <select class="form-control" name="Tier" id='Tier' #Tier="ngModel" [(ngModel)]="ObjaddbillForm.Tier" (keydown)="onKeydownMain($event,'Base')">
                                      <option  [ngValue]="undefined">Select</option>
                                  <option *ngFor = "let option of Tierlist" [value] ="option.Txn_ID">
                                        {{option.Field_Value}}
                                  </option>
                          </select>
                                        </div>
                                        <div class="col-sm-2">
                                            <label class="control-label">Base</label>
                                            <select class="form-control" name="Base" id='Base' #Base="ngModel" [(ngModel)]="ObjaddbillForm.Base" (keydown)="onKeydownMain($event,'Boxes')">
                                      <option  [ngValue]="undefined">Select</option>
                                  <option *ngFor = "let option of Baselist" [value] ="option.Txn_ID">
                                        {{option.Field_Value}}
                                  </option>
                          </select>
                                        </div>
                                        <div class="col-sm-2">
                                            <label class="control-label">Fancy Boxes</label>
                                            <input class="form-control" name="Boxes" #Boxes="ngModel" id='Boxes' [(ngModel)]="ObjaddbillForm.Boxes" (keydown)="onKeydownMain($event, 'Changes_On_Cake')" [ngClass]="{'clearance':addbillFormSubmitted && Boxes?.errors?.required}">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-2">
                                            <label class="control-label">Changes On Cake</label>
                                            <!-- <textarea class="form-control" name="Changes_on_Cake" #Changes_on_Cake="ngModel" id='Changes_On_Cake' [(ngModel)]="ObjaddbillForm.Changes_on_Cake"></textarea> -->
                                            <!-- <div class="form-group" style="margin-left:3px;margin-right: 0px;">
                                                <p-editor name= "Changes_on_Cake"
                                                #Changes_on_Cake="ngModel"
                                                [(ngModel)]="ObjaddbillForm.Changes_on_Cake"
                                                [style]="{'height':'200px'}">
                                                </p-editor>
                                            </div> -->
                                            <p-editor 
                                            name= "Changes_on_Cake" #Changes_on_Cake="ngModel" [(ngModel)]="ObjaddbillForm.Changes_on_Cake" [style]="{'height':'80px'}">
                                                <p-header>
                                                    <!-- <span class="ql-formats">
                                                        <button class="ql-bold" aria-label="Bold"></button>
                                                        <button class="ql-italic" aria-label="Italic"></button>
                                                        <button class="ql-underline" aria-label="Underline"></button>
                                                    </span> -->
                                                </p-header>
                                            </p-editor>
                                        </div>
                                        <div class="col-sm-2">
                                            <label class="control-label">Order Taken By</label>
                                            <input class="form-control" name="Order_Taken_By" #Order_Taken_By="ngModel" id='Order_Taken_By' [(ngModel)]="ObjaddbillForm.Order_Taken_By" (keydown)="onKeydownMain($event, 'Modifier1')" [ngClass]="{'clearance':addbillFormSubmitted && Modifier1?.errors?.required}">
                                        </div>
                                        <div class="col-sm-2">
                                            <label class="control-label">Message 1 On Cake </label>
                                            <input class="form-control" name="Modifier1" #Modifier1="ngModel" id='Modifier1' [(ngModel)]="ObjaddbillForm.Modifier1" (keydown)="onKeydownMain($event, 'Modifier2')" [ngClass]="{'clearance':addbillFormSubmitted && Modifier2?.errors?.required}">
                                        </div>
                                        <div class="col-sm-2">
                                            <label class="control-label">Message 2 On Cake </label>
                                            <input class="form-control" name="Modifier2" #Modifier2="ngModel" id='Modifier2' [(ngModel)]="ObjaddbillForm.Modifier2" (keydown)="onKeydownMain($event, 'Modifier3')" [ngClass]="{'clearance':addbillFormSubmitted && Modifier2?.errors?.required}">
                                        </div>
                                        <div class="col-sm-2">
                                            <label class="control-label">Message 3 On Cake </label>
                                            <input class="form-control" name="Modifier3" #Modifier3="ngModel" id='Modifier3' [(ngModel)]="ObjaddbillForm.Modifier3" (keydown)="onKeydownMain($event, 'Modifier4')" [ngClass]="{'clearance':addbillFormSubmitted && Modifier3?.errors?.required}">
                                        </div>
                                        <div class="col-sm-2">
                                            <label class="control-label">Message 4 on Cake </label>
                                            <input class="form-control" name="Modifier4" #Modifier4="ngModel" id='Modifier4' [(ngModel)]="ObjaddbillForm.Modifier4" (keydown)="onKeydownMain($event, 'Modifier5')" [ngClass]="{'clearance':addbillFormSubmitted && Modifier4?.errors?.required}">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <!-- </div> -->
                                        <div class="col-sm-2">
                                            <label class="control-label">Message 5 on Cake </label>
                                            <input class="form-control" name="Modifier5" #Modifier5="ngModel" id='Modifier5' [(ngModel)]="ObjaddbillForm.Modifier5" (keydown)="onKeydownMain($event, 'DelCharge')" [ngClass]="{'clearance':addbillFormSubmitted && Modifier5?.errors?.required}">
                                        </div>
                                        <div class="col-sm-2">
                                            <label class="control-label">Delivery Charge</label>
                                            <input class="form-control" name="DelCharge" #DelCharge="ngModel" id='DelCharge' [(ngModel)]="ObjaddbillForm.Delivery_Charge" (keydown)="onKeydownMain($event, 'enter')" [ngClass]="{'clearance':addbillFormSubmitted && DelCharge?.errors?.required}" CompacctDigitonly="true">
                                        </div>
                                        <div>
                                            <button id="row-Add" class="btn btn-primary custombutton2" (click)="add(addbillForm.form.valid)">
                                                Add
                                            </button>
                                        </div>
                                    </div>


                                    <br>
                                    <div class="table-responsive no-padding">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr style="background-color:#3c8dbc;color:white;">
                                                    <th>Description</th>
                                                    <th>Rate</th>
                                                    <th>Delivery <br> Charge</th>
                                                    <th>Qty</th>
                                                    <th>Wight in <br> Pound</th>
                                                    <th>Accomplishment <br> Amt</th>
                                                    <th>Amount</th>
                                                    <th>Taxable B4 Disc.</th>
                                                    <th>Dis %</th>
                                                    <th>Dis Amt</th>
                                                    <th>Taxable</th>
                                                    <th>SGST % / <br> SGST Amt</th>
                                                    <!-- <th>SGST Amt</th> -->
                                                    <th>CGST % / <br> CGST Amt</th>
                                                    <!-- <th>CGST Amt</th> -->
                                                    <th>IGST % / <br> IGST Amt</th>
                                                    <th>Net Amt</th>
                                                    <th>Delete</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- ngRepeat: obj in ctrl.ProductCategoryGST -->
                                                <tr *ngFor="let obj of productSubmit ;let ind = index;">
                                                    <td><b>{{obj.Product_Description}}</b> <br>
                                                        <!-- <i *ngIf='obj.Modifier' style="color: rgb(223, 25, 25);">
                                        {{obj.Modifier}}
                                      </i>  -->
                                                        <i><tr *ngIf="obj.Modifier1">Message 1 -<td>{{obj.Modifier1}}</td></tr>
                                                        <tr *ngIf="obj.Modifier2">Message 2 -<td>{{obj.Modifier2}}</td></tr>
                                                        <tr *ngIf="obj.Modifier3">Message 3 -<td>{{obj.Modifier3}}</td></tr>
                                                        <tr *ngIf="obj.Modifier4">Message 4 -<td>{{obj.Modifier4}}</td></tr>
                                                        <tr *ngIf="obj.Modifier5">Message 5 -<td>{{obj.Modifier5}}</td></tr></i><br>

                                                        <tr *ngIf="obj.Flavour">Flavour -
                                                            <td class="text-muted">{{obj.Flavour}}</td>
                                                        </tr>
                                                        <tr *ngIf="obj.Finishing">Finishing -
                                                            <td class="text-muted">{{obj.Finishing}}</td>
                                                        </tr>
                                                        <tr *ngIf="obj.Shape">Shape -
                                                            <td class="text-muted">{{obj.Shape}}</td>
                                                        </tr>
                                                        <tr *ngIf="obj.Tier">Tier -
                                                            <td class="text-muted">{{obj.Tier}}</td>
                                                        </tr>
                                                        <tr *ngIf="obj.Base">Base -
                                                            <td class="text-muted">{{obj.Base}}</td>
                                                        </tr>
                                                        <tr *ngIf="obj.Boxes">Boxes -
                                                            <td class="text-muted">{{obj.Boxes}}</td>
                                                        </tr>
                                                        <tr *ngIf="obj.Changes_on_Cake">Changes On Cake -
                                                            <!-- <td class="text-muted">{{obj.Changes_on_Cake}}</td> -->
                                                            <!-- <td><textarea [name]="obj.Product_ID" [(ngModel)]="obj.Changes_on_Cake" class="form-control" style="width: 200px;"></textarea></td> -->
                                                            <td><p-editor 
                                                            [name]="obj.Changes_on_Cake" [(ngModel)]="obj.Changes_on_Cake" [style]="{'height':'80px'}" [readonly]="true">
                                                            <p-header>
                                                            </p-header>
                                                            </p-editor></td>
                                                        </tr>
                                                        <tr *ngIf="obj.Order_Taken_By">Order Taken By -
                                                            <td class="text-muted">{{obj.Order_Taken_By}}</td>
                                                        </tr>
                                                        <!-- <tr *ngIf="obj.Weight_in_Pound">Weight in Pound -<td class="text-muted">{{obj.Weight_in_Pound}}</td></tr>
                                        <tr *ngIf="obj.Acompanish">Accomplish -<td class="text-muted">{{obj.Acompanish}}</td></tr> -->

                                                        <!-- <tr><td>{{obj.Finishing}}</td></tr>
                                        <tr>{{obj.Shape}}</tr>
                                        <tr>{{obj.Tier}}</tr>
                                        <tr>{{obj.Base}}</tr>
                                        <tr>{{obj.Boxes}}</tr>
                                        <tr>{{obj.Changes_On_Cake}}</tr>
                                        <tr>{{obj.Weight_in_Pound}}</tr>
                                        <tr>{{obj.Order_Taken_By}}</tr> -->

                                                    </td>
                                                    <td>{{obj.Net_Price}}</td>
                                                    <td>{{obj.Delivery_Charge}}</td>
                                                    <td>{{obj.Stock_Qty}}</td>
                                                    <td>{{obj.Weight_in_Pound}}</td>
                                                    <td>{{obj.Acompanish}}</td>
                                                    <td>{{obj.Amount}}</td>
                                                    <td>{{obj.Amount_berore_Tax}}</td>
                                                    <td>{{obj.Max_Discount}}</td>
                                                    <td>{{obj.Dis_Amount}}</td>
                                                    <td>{{obj.Taxable}}</td>
                                                    <td>{{obj.SGST_Per}} <br> {{obj.SGST_Amount}}
                                                    </td>
                                                    <!-- <td>{{obj.SGST_Amount}}</td> -->
                                                    <td>{{obj.CGST_Per}} <br> {{obj.CGST_Amount}}
                                                    </td>
                                                    <!-- <td>{{obj.CGST_Amount}}</td> -->
                                                    <td>{{obj.GST_Tax_Per}} <br> {{obj.GST_Tax_Per_Amt}}
                                                    </td>
                                                    <td>{{obj.Net_Amount}}</td>
                                                    <td><button (click)="delete(ind)" class="btn danger"><i class="fa fa-trash"></i></button></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </fieldset>
                            </form><br class="ng-scope">
                            <form name="SavePrintForm" #SavePrintForm="ngForm" novalidate>

                                <hr class="box boxboxDivide-primary ng-scope">

                                <div class="col-sm-4">
                                    <div class="box box-success2 well2 well-sm2 shadow ">
                                        <div class="form-group">
                                            <div class='col-sm-12'>
                                                <label class="control-label">Customer Mobile <sup class="text-danger">*</sup></label>
                                                <input class="form-control" name="Costomer_Mobile" #Costomer_Mobile="ngModel" [(ngModel)]="Objcustomerdetail.Costomer_Mobile" maxlength="10" id='Customer' [disabled]='CustomerDisabledFlag' (keydown)="onKeydownMain($event, 'CustomerName')" placeholder="Customer Mobile">
                                            </div>
                                            <div class='col-sm-12'>
                                                <label class="control-label">Customer Name <sup class="text-danger">*</sup></label>
                                                <input class="form-control" name="Customer_Name" id='CustomerName' #Customer_Name="ngModel" [disabled]='CustomerDisabledFlag' (keydown)="onKeydownMain($event, 'Customer_DOB')" [(ngModel)]="Objcustomerdetail.Customer_Name" placeholder="Customer Name">
                                            </div>
                                            <div class='col-sm-12'>
                                                <label class="control-label">Date of Birth</label>
                                                <input class="form-control" name="Customer_DOB" id='Customer_DOB' #Customer_DOB="ngModel" [disabled]='CustomerDisabledFlag' (keydown)="onKeydownMain($event, 'Customer_Anni')" [(ngModel)]="Objcustomerdetail.Customer_DOB" placeholder="dd/MM/yyyy">
                                                <!-- <ejs-datepicker  [format]="'dd/MMM/yyyy'"
                                               id='Customer_DOB'
                                               name="Customer_DOB"
                                               #Customer_DOB = "ngModel"
                                               (keydown)="onKeydownMain($event, 'Customer_Anni')"
                                               [(ngModel)] ="Objcustomerdetail.Customer_DOB"
                                               [enabled]='!CustomerDisabledFlag'
                                               placeholder="dd/MMM/yyyy">
                                          </ejs-datepicker> -->

                                            </div>
                                            <div class='col-sm-12'>
                                                <label class="control-label">Anniversary</label>
                                                <input class="form-control" name="Customer_Anni" id='Customer_Anni' #Customer_Anni="ngModel" [disabled]='CustomerDisabledFlag' (keydown)="onKeydownMain($event, 'Customer_GST')" [(ngModel)]="Objcustomerdetail.Customer_Anni" placeholder="dd/MM/yyyy">
                                                <!-- <ejs-datepicker  [format]="'dd/MMM/yyyy'"
                                               id='Customer_Anni'
                                               name="Customer_Anni"
                                               #Customer_Anni = "ngModel"
                                               (keydown)="onKeydownMain($event, 'Customer_GST')"
                                               [(ngModel)] ="Objcustomerdetail.Customer_Anni"
                                               [enabled]='!CustomerDisabledFlag'
                                               placeholder="dd/MMM/yyyy">
                                          </ejs-datepicker> -->

                                            </div>
                                            <div class='col-sm-12'>
                                                <label class="control-label">Customer GST</label>
                                                <input class="form-control" #Customer_Gst name="Customer_GST" placeholder="Customer GST" #Customer_GST="ngModel" id='Customer_GST' [disabled]='CustomerDisabledFlag' (keydown)="onKeydownMain($event, 'Bill_Remarks')" (ngModelChange)='checkGSTvalid(Objcustomerdetail.Customer_GST)'
                                                    [(ngModel)]="Objcustomerdetail.Customer_GST" minlength="15" maxlength="15" [ngClass]="{
                                                 clearance:
                                                   (GSTvalidFlag) ||
                                                   (Customer_GST.errors?.minlength && Customer_GST.touched)
                                               }">

                                            </div>
                                            <div class='col-sm-12'>
                                                <label class="control-label">Remarks</label>
                                                <input class="form-control" name="Bill_Remarks" #Bill_Remarks="ngModel" id='Bill_Remarks' (keydown)="onKeydownMain($event, 'save')" [(ngModel)]="Objcustomerdetail.Bill_Remarks" placeholder="Remarks">
                                                <!-- <textarea
                                      [rows]="3" [cols]="20" pInputTextarea autoResize="autoResize"
                                      ></textarea> -->
                                            </div>
                                        </div>
                                    </div>


                                </div>



                                <div class="col-sm-4">
                                    <div class="box box-success1 well1 well-sm1 shadow ">
                                        <div class="form-horizontal">
                                            <div class="box-body1">
                                                <div class="form-group">
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Amount:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{Amount}}
                                                    </div>

                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Discount Amount:</label> &nbsp;&nbsp;&nbsp; {{Dis_Amount}}
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Taxable Amount:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{Totaltaxable}}
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">SGST Amount:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{SGST_Amount}}
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">CGST Amount:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{CGST_Amount}}
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">IGST Amount:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{GST_Tax_Per_Amt}}
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Net Amount:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{Total}}
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="box box-success1 well1 well-sm1 shadow " *ngIf="!QueryStringObj?.Sub_Ledger_ID">
                                        <div class="form-horizontal">
                                            <div class="box-body1"> <br>
                                                <div class="form-group">
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Cuppon No</label> &nbsp;&nbsp;&nbsp;
                                                        <input type="text" size="12" Style="border: 3px solid #aaa;" name="cupponno" #cupponno="ngModel" id='cupponno' (keydown)="onKeydownMain($event, 'enterotp')" [(ngModel)]="Objcustomerdetail.Cuppon_No" CompacctDigitonly="true">                                                        &nbsp;&nbsp;&nbsp;&nbsp;

                                                        <button type="button" class="btn btn-success"> GET OTP </button>
                                                    </div>
                                                </div> <br>

                                                <div class="form-group">
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Enter OTP</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                        <input type="text" size="12" Style="border: 3px solid #aaa;" name="enterotp" #enterotp="ngModel" id='enterotp' (keydown)="onKeydownMain($event, 'save')" [(ngModel)]="Objcustomerdetail.Cuppon_OTP" CompacctDigitonly="true">                                                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

                                                        <button type="button" class="btn btn-warning"> VALID </button>

                                                    </div>
                                                </div> <br>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                                <div class="col-sm-4">
                                    <div class="box box-success well well-sm shadow ">
                                        <div class="form-horizontal">
                                            <div class="box-body">
                                                <div class="form-group">
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Total Amount:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{Total}}
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Rounded Off:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{Round_Off}}
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Amount Payable:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{Amount_Payable}}
                                                    </div>
                                                    <div class='col-sm-12' *ngIf="!QueryStringObj?.Sub_Ledger_ID">
                                                        <label class="control-label">Cash Amount:</label>
                                                        <input class="form-control" type="text" style="text-align: center" name="cash" #cash="ngModel" [(ngModel)]="ObjcashForm.Cash_Amount" (ngModelChange)="AmountChange()" CompacctDigitonly="true">
                                                    </div>
                                                    <div class='col-sm-12' *ngIf="!QueryStringObj?.Sub_Ledger_ID">
                                                        <label class="control-label">Other Payment Mode: </label>
                                                        <div *ngIf="LedgerNameforupi === 'UPI' && ObjcashForm.Wallet_Amount" class="pull-right" style="margin-top: -2px;">
                                                            <button (click)="getdataforrequestdetailsupi()" class="btn createPatient" [disabled]="txnbuttondisabledupi" style="background-color: #587ea3; color: white;"> Request</button> &nbsp; 
                                                            <button  (click)="CheckTransactionupi()" class="btn createPatient" [disabled]="confirmtxnflagupi" style="background-color: #587ea3; color: white;"> Confirm</button>
                                                        </div>
                                                        <div class="input-group">
                                                            <div class="input-group-addon">
                                                                <select name="wallet" #wallet="ngModel" [(ngModel)]="ObjcashForm.Wallet_Ac_ID" [disabled]='QueryStringObj?.Txn_ID || txndisabledupi' (change)="getledgername()">
                                                                    <option [ngValue]="undefined">select</option>
                                                                    <option *ngFor = "let option of walletlist" [value] ="option.Txn_ID">
                                                                        {{option.Ledger_Name}}
                                                                    </option>
                                                                </select>
                                                            </div>
                                                            <input type="text" class="form-control" id="exampleInputAmount" name="Wallet" #Wallet="ngModel" [(ngModel)]="ObjcashForm.Wallet_Amount" (ngModelChange)="AmountChange()" CompacctDigitonly="true" [disabled]='QueryStringObj?.Txn_ID || txndisabledupi'>
                                                        </div>
                                                    </div>

                                                    <div class='col-sm-12' *ngIf="!QueryStringObj?.Sub_Ledger_ID">
                                                        <label class="control-label">Card Amount: </label>
                                                        <div *ngIf="ObjcashForm.Card_Amount" class="pull-right" style="margin-top: -2px;">
                                                            <button (click)="getdataforrequestdetails()" class="btn createPatient" [disabled]="txnbuttondisabled" style="background-color: #587ea3; color: white;"> Request</button> &nbsp; 
                                                            <button  (click)="CheckTransaction()" class="btn createPatient" [disabled]="confirmtxnflag" style="background-color: #587ea3; color: white;"> Confirm</button>
                                                        </div>
                                                        <input class="form-control" type="text" style="text-align: center" name="card" #card="ngModel" [disabled]='txndisabled' [(ngModel)]="ObjcashForm.Card_Amount" (ngModelChange)="AmountChange()" CompacctDigitonly="true">
                                                    </div>
                                                    <div class='col-sm-12' *ngIf="!QueryStringObj?.Sub_Ledger_ID">
                                                        <div class="form-group">
                                                            <div class='col-sm-9'>
                                                                <label class="control-label">Credit to Account:</label>
                                                                <div class="input-group">
                                                                    <div class="input-group-addon">
                                                                        <select name="Credit" #Credit="ngModel" [(ngModel)]="ObjcashForm.Credit_To_Ac_ID">
                                                                          <option [ngValue]="undefined">select</option>
                                                                          <option *ngFor = "let option of creditlist" [value] ="option.Txn_ID">
                                                                              {{option.Ledger_Name}}
                                                                          </option>
                                                                      </select>
                                                                    </div>
                                                                    <input type="text" class="form-control" id="exampleInputAmount1" name="credit" #credit="ngModel" [(ngModel)]="ObjcashForm.Credit_To_Amount" (ngModelChange)="CalculateDiscount()" CompacctDigitonly="true">
                                                                </div>
                                                            </div>
                                                            <div class='col-sm-1'>
                                                                <div class="pull-right5" style="width:100px;">
                                                                    <small>Coupon %</small> <br>
                                                                    <input type="text" size="1" style="text-align: center" name="couponper" #couponper="ngModel" [(ngModel)]="ObjcashForm.Coupon_Per" (ngModelChange)="couponperchange()" CompacctDigitonly="true">

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Additional Payment:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{Additional_Payment}}
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Total Paid:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{ObjcashForm.Total_Paid}}
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Net Due:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{ObjcashForm.Net_Due}}
                                                    </div>


                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </form>

                            <hr class="box boxboxDivide-primary ng-scope">


                            <div class="form-group">
                                <div class="col-sm-2 pull-right">
                                    <p-checkbox label="HOLD ORDER" (onChange)='HoldBill()' [(ngModel)]="Hold_Order_Flag" [binary]="true"></p-checkbox>
                                    <!-- <input type="checkbox"  style="margin: 10px 3px;"  (change)="HoldBill()" class="ng-valid ng-dirty ng-valid-parse ng-touched" aria-invalid="false">
                          <label for="vehicle1">
                              <small>Hold Bill</small></label> -->
                                </div>
                            </div>
                            <div class="box-footer">


                                <button class="btn btn-primary pull-right" (click)="saveCheck()" id="load" [disabled]="Spinner">
                         <p-progressSpinner *ngIf="Spinner" [style]="{width: '15px', height: '15px'}" strokeWidth="8"  animationDuration=".5s"></p-progressSpinner>
                     <span *ngIf="!Spinner" class="glyphicon glyphicon-save"></span>{{buttonname}}
                 </button>
                            </div>
                            <!-- Home Delivery Popup -->
                            <p-dialog header="Customer Details" [appendTo]="'body'" [(visible)]="HomeDeliverypopup" [modal]="true" [responsive]="true" [closeOnEscape]="true" [baseZIndex]="123" [style]="{ width: '36%', minWidth: '200px' }">

                                <form name="CustomerDetailsForm" #CustomerDetailsForm="ngForm" novalidate>
                                    <div>
                                        <div class="form-group">
                                            <div class='col-sm-12'>
                                                <label class="control-label">Customer Mobile No.<sup class="text-danger">*</sup></label>
                                                <input class="form-control" name="Costomer_Mobile" #Costomer_Mobile="ngModel" [(ngModel)]="ObjHomeDelivery.Delivery_Mobile_No" maxlength="10" id='Customer' CompacctDigitonly="true" [ngClass]="{
                   clearance:
                     (CustomerDetailsFormSubmitted && Costomer_Mobile.errors?.required) ||
                     (Costomer_Mobile.errors?.minlength && Costomer_Mobile.touched)
                 }" required placeholder="Customer Mobile">
                                            </div>
                                            <div class='col-sm-12'>
                                                <label class="control-label">Alternative Mobile No.</label>
                                                <input class="form-control" name="Alternative_Mobile" #Alternative_Mobile="ngModel" [(ngModel)]="ObjHomeDelivery.Delivery_Alt_Mobile_No" maxlength="10" id='Customer2' CompacctDigitonly="true" placeholder="Alternative Mobile No.">
                                            </div>
                                            <div class='col-sm-12'>
                                                <label class="control-label">Customer Name <sup class="text-danger">*</sup></label>
                                                <input class="form-control" name="Customer_Name" id='CustomerName' #Customer_Name="ngModel" [(ngModel)]="ObjHomeDelivery.Delivery_Name" [ngClass]="{clearance:CustomerDetailsFormSubmitted && Customer_Name.errors?.required}" placeholder="Customer Name"
                                                    required>
                                            </div>
                                            <div class='col-sm-12'>
                                                <label class="control-label">Address</label>
                                                <input class="form-control" name="Address" id='Address' #Address="ngModel" [(ngModel)]="ObjHomeDelivery.Delivery_Address" placeholder="Address">
                                            </div>
                                            <div class='col-sm-12'>
                                                <label class="control-label">Near By</label>
                                                <input class="form-control" name="Near_By" id='Near_By' [(ngModel)]="ObjHomeDelivery.Delivery_Near_By" #location Compacct-Place (setAddress)="getAddressOnChange($event)" placeholder="Near By">
                                            </div>

                                            <div class='col-sm-12'>
                                                <label class="control-label">Pin Code</label>
                                                <input class="form-control" name="Pin_Code" id='Pin_Code' #Pin_Code="ngModel" maxlength="6" [(ngModel)]="ObjHomeDelivery.Delivery_Pin_Code" placeholder="Pin Code" CompacctDigitonly="true">
                                            </div>

                                        </div>

                                        <!-- <textarea class="form-control"
                 name="Bill_Remarks"
                 #Bill_Remarks = "ngModel"
                 id='Bill_Remarks'
                 (keydown)="onKeydownMain($event, 'save')"
                 [(ngModel)] ="Objcustomerdetail.Remarks"
                 placeholder="Remarks"></textarea> -->
                                        <!-- <textarea
        [rows]="3" [cols]="20" pInputTextarea autoResize="autoResize"
        ></textarea> -->

                                    </div>
                                </form>
                                <p-footer>
                                    <!-- <button type="button" (click)="HomeDeliverypopup = false" class="btn btn-default">
      <i class="fa fa-fw fa-close" ></i>&nbsp;  CANCEL
    </button> -->
                                    <button type="button" class="btn btn-primary" (click)="DeliveryDetailSubmit()">
      <i class="pi pi-check" ></i>&nbsp; OK
    </button>
                                </p-footer>
                            </p-dialog>
                        </p-tabPanel>
                    </p-tabView>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- REFUND -->
<p-dialog header="REFUND" [appendTo]="'body'" [visible]="RefundPopup" [closeOnEscape]="true" [closable]="false" [modal]="true" [responsive]="true" [style]="{ width: '30%', minWidth: '200px' }" style="text-align: center;" [minY]="80" [maximizable]="true"
    [baseZIndex]="10000">
    <div class="col-sm-6">
        <div class="box box-successMP wellMP well-smMP shadow">
            <div class="form-horizontal">
                <div class="box-body">
                    <div class="form-group">
                        <div class='col-sm-12'>
                            <label class="control-label">Amount Received:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{RAmount_Payable}}
                        </div>
                        <div class='col-sm-12'>
                            <label class="control-label">Cash Amount:</label>
                            <input class="form-control" type="text" style="text-align: center" name="Rcash" #Rcash="ngModel" [(ngModel)]="ObjRefundcashForm.Cash_Amount" CompacctDigitonly="true">
                        </div>
                        <div class='col-sm-12'>
                            <label class="control-label">Wallet Amount: </label>
                            <div class="input-group">
                                <div class="input-group-addon">
                                    <select name="Rwallet" #Rwallet="ngModel" [(ngModel)]="ObjRefundcashForm.Wallet_Ac_ID" [disabled]='true'>
                                                              <option [ngValue]="undefined">select</option>
                                                              <option *ngFor = "let option of walletlist" [value] ="option.Txn_ID">
                                                                  {{option.Ledger_Name}}
                                                              </option>
                                                          </select>
                                </div>
                                <input type="text" class="form-control" id="exampleInputAmount" name="RWallet" #RWallet="ngModel" [(ngModel)]="ObjRefundcashForm.Wallet_Amount" CompacctDigitonly="true" [disabled]='true'>
                            </div>
                        </div>


                        <!-- <div class='col-sm-12'>
                                                        <label class="control-label">Total Paid:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{ObjcashForm.Total_Paid}}
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Net Due:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{ObjcashForm.Net_Due}}
                                                    </div> -->

                    </div>

                </div>
            </div>
        </div>
    </div>
    <p-footer>
        <button type="button" (click)="RefundPopup = false" class="btn btn-default">
                                        <i class="fa fa-fw fa-close" ></i>&nbsp;  Close
                                    </button>
        <button type="button" class="btn btn-primary" (click)="RefundSave()">
                                        <i class="fa fa-money" ></i>&nbsp; Refund
                                    </button>
    </p-footer>
</p-dialog>

<!-- PHOTO UPLOAD -->
<p-dialog header="Photo Upload" [appendTo]="'body'" [visible]="PhotoUploadPopup" [closeOnEscape]="true" [closable]="false" [modal]="true" [responsive]="true" [style]="{ width: '80%', minWidth: '300px' }" style="text-align: center;" [minY]="80" [maximizable]="true"
    [baseZIndex]="10000">
    <!-- <div class="clearfix"></div> -->
    <div class="table-responsive no-padding table-id">
        <table class="table table-bordered">
            <thead>
                <tr style="background-color:#3c8dbc;color:white;">

                    <th>Adv Order No.</th>
                    <th>Product Description</th>
                    <th>Qty</th>
                    <th>Image</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody *ngFor="let col of photoforproductList;let i =index">
                <tr>
                    <td>{{col.Adv_Order_No}}</td>
                    <td>{{col.Product_Description}}</td>
                    <td>{{col.Qty}}</td>
                    <td>
                        <p-fileUpload #fileInput *ngIf="!col.PDFViewFlag" name="{{i+'name'}}" accept="image/*,application/pdf" customUpload="true" [chooseLabel]="'Browse'" [showUploadButton]="false" (onSelect)="FetchPDFFile($event,i)" url="/K4C_Outlet_Advance_Order/Upload_Doc">
                        </p-fileUpload>
                        <a [href]="col.ProductPDFLink" *ngIf="col.PDFViewFlag" style="display: block;">
                            <img [src]="col.ProductPDFLink" class='img-rounded pdf' style="width:100px; height:100px " alt="image">
                        </a>
                    </td>
                    <td><button type="button" (click)="upload(i)" [id]="col.Product_ID" [disabled]="col.uploadbuttondisabled" class="btn btn-primary">
                        <p-progressSpinner *ngIf="col.uploadSpinner" [style]="{width: '15px', height: '15px'}" strokeWidth="8"  animationDuration=".5s"></p-progressSpinner>
                                         <span class="'fa fa-fw fa fa-upload" *ngIf="!col.uploadSpinner" ></span>
                                         Upload
                      </button></td>


                      <!-- <td> 
                        <p-fileUpload #fileInput *ngIf="!PDFViewFlag" name="pan" accept="image/*,application/pdf" customUpload="true" [chooseLabel]="'Browse'" [showUploadButton]="false" (onSelect)="FetchPDFFile($event)" >
                        </p-fileUpload>
                        <a [href]="col.ProductPDFLink" *ngIf="col.PDFViewFlag" style="display: block;">
                            <img [src]="col.ProductPDFLink" class='img-rounded pdf' style="width:100px; height:100px " alt="image">
                        </a>
                    </td>
                    <td><button type="button" (click)="upload()" class="btn btn-primary">
                        <p-progressSpinner *ngIf="col.uploadSpinner" [style]="{width: '15px', height: '15px'}" strokeWidth="8"  animationDuration=".5s"></p-progressSpinner>
                                         <span class="'fa fa-fw fa fa-upload" *ngIf="!col.uploadSpinner" ></span>
                                         Upload
                      </button></td> -->

                </tr>
            </tbody>
        </table>
    </div>
    <p-footer>
        <button *ngIf="this.adornumber" type="button" (click)="ClosePicuploadpopup()" class="btn btn-success">
            <span class="'fa fa-fw fa fa-check"></span>
                                  Done
        </button>
        <button *ngIf="!this.adornumber" type="button" (click)="PhotoUploadPopup=false" class="btn btn-default">
            <span class="'fa fa-fw fa fa-times"></span>
            CLOSE
       </button>
    </p-footer>
</p-dialog>

<!-- UPDATE PAYMENT MODE -->
<p-dialog header="Update Payment Mode" [appendTo]="'body'" [(visible)]="UpdatePayModeModal" [closeOnEscape]="true" [closable]="false" [modal]="true" [responsive]="true" [style]="{ width: '30%', minWidth: '200px' }" style="text-align: center;" [minY]="80" [maximizable]="true"
                                [baseZIndex]="10000">
                                <div class="col-sm-6">
                                    <div class="box box-successMP wellMP well-smMP shadow">
                                        <div class="form-horizontal">
                                            <div class="box-body">
                                                <div class="form-group">
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Amount Payable:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{ObjUpdatePayMode.Amount_Payable}}
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Cash Amount:</label>
                                                        <input class="form-control" type="text" style="text-align: center" name="cash" #cash="ngModel" [(ngModel)]="ObjUpdatePayMode.Cash_Amount"  CompacctDigitonly="true">
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Wallet Amount: </label>
                                                        <div class="input-group">
                                                            <div class="input-group-addon">
                                                                <select name="wallet" #wallet="ngModel" [(ngModel)]="ObjUpdatePayMode.Wallet_Ac_ID" >
                                                              <option [ngValue]="undefined">select</option>
                                                              <option *ngFor = "let option of walletlist" [value] ="option.Txn_ID">
                                                                  {{option.Ledger_Name}}
                                                              </option>
                                                          </select>
                                                            </div>
                                                            <input type="text" class="form-control" id="exampleInputAmount" name="Wallet" #Wallet="ngModel" [(ngModel)]="ObjUpdatePayMode.Wallet_Amount"  CompacctDigitonly="true">
                                                        </div>
                                                    </div>

                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Card Amount: </label>
                                                        <input class="form-control" type="text" style="text-align: center" name="card" #card="ngModel" [(ngModel)]="ObjUpdatePayMode.Card_Amount"  CompacctDigitonly="true">
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Credit to Account:</label>
                                                        <div class="input-group">
                                                            <div class="input-group-addon">
                                                                <select name="Credit" #Credit="ngModel" [(ngModel)]="ObjUpdatePayMode.Credit_To_Ac_ID">
                                                                    <option [ngValue]="undefined">select</option>
                                                                    <option *ngFor = "let option of creditlist" [value] ="option.Txn_ID">
                                                                        {{option.Ledger_Name}}
                                                                    </option>
                                                                </select>
                                                            </div>
                                                            <input type="text" class="form-control" id="exampleInputAmount1" name="credit" #credit="ngModel" [(ngModel)]="ObjUpdatePayMode.Credit_To_Amount" [disabled]="true" CompacctDigitonly="true">
                                                        </div>
                                                    </div>

                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Total Paid:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{ObjUpdatePayMode.Total_Paid}}
                                                    </div>
                                                    <div class='col-sm-12'>
                                                        <label class="control-label">Net Due:</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{ObjUpdatePayMode.Net_Due}}
                                                    </div>

                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <p-footer>
                                    <button type="button" (click)="UpdatePayModeModal = false" class="btn btn-default">
                                  CLOSE
                                </button>
                                    <button type="button" (click)="UpdatePMode()" class="btn btn-success">
                                  UPDATE
                                </button>
                                </p-footer>
</p-dialog>